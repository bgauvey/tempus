@page "/Account/Login"
@using System.ComponentModel.DataAnnotations
@using Microsoft.AspNetCore.Identity
@using Tempus.Core.Models

@inject NavigationManager NavigationManager

<PageTitle>Sign In - Tempus Time Management Platform</PageTitle>

<div class="auth-page-container">
    <!-- Left Side - Branding -->
    <div class="auth-branding-section">
        <div class="auth-branding-content">
            <div class="auth-logo">
                <RadzenIcon Icon="schedule" Style="font-size: 3rem;" />
            </div>
            <h1 class="auth-branding-title">Welcome to Tempus</h1>
            <p class="auth-branding-subtitle">
                The enterprise-grade time management platform trusted by 50,000+ professionals worldwide.
            </p>
            <div class="auth-features">
                <div class="auth-feature-item">
                    <RadzenIcon Icon="check_circle" />
                    <span>AI-Powered Scheduling</span>
                </div>
                <div class="auth-feature-item">
                    <RadzenIcon Icon="check_circle" />
                    <span>Advanced Analytics</span>
                </div>
                <div class="auth-feature-item">
                    <RadzenIcon Icon="check_circle" />
                    <span>Team Collaboration</span>
                </div>
                <div class="auth-feature-item">
                    <RadzenIcon Icon="check_circle" />
                    <span>Enterprise Security</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Right Side - Login Form -->
    <div class="auth-form-section">
        <div class="auth-form-container">
            <div class="auth-form-header">
                <div class="auth-icon-wrapper">
                    <RadzenIcon Icon="login" />
                </div>
                <h2 class="auth-form-title">Sign In to Your Account</h2>
                <p class="auth-form-subtitle">Enter your credentials to access your calendar</p>
            </div>

            @if (!string.IsNullOrEmpty(errorMessage))
            {
                <div class="auth-alert-error">
                    <RadzenIcon Icon="error" Style="font-size: 1.25rem;" />
                    <span>@errorMessage</span>
                </div>
            }

            <form method="post" action="/Account/PerformLogin" class="auth-form">
                <AntiforgeryToken />

                <div class="auth-form-field">
                    <label class="auth-form-label">
                        <RadzenIcon Icon="email" Style="font-size: 1rem; margin-right: 0.5rem;" />
                        Email Address
                    </label>
                    <input type="email"
                           name="email"
                           required
                           placeholder="your@email.com"
                           class="auth-form-input"
                           autocomplete="email" />
                </div>

                <div class="auth-form-field">
                    <label class="auth-form-label">
                        <RadzenIcon Icon="lock" Style="font-size: 1rem; margin-right: 0.5rem;" />
                        Password
                    </label>
                    <input type="password"
                           name="password"
                           required
                           placeholder="Enter your password"
                           class="auth-form-input"
                           autocomplete="current-password" />
                </div>

                <div class="auth-form-options">
                    <label class="auth-checkbox-label">
                        <input type="checkbox" name="rememberMe" value="true" class="auth-checkbox" />
                        <span>Remember me for 30 days</span>
                    </label>
                    <a href="/Account/ForgotPassword" class="auth-link">Forgot password?</a>
                </div>

                <input type="hidden" name="returnUrl" value="@ReturnUrl" />

                <button type="submit" class="auth-submit-button">
                    <RadzenIcon Icon="arrow_forward" Style="font-size: 1.25rem; margin-right: 0.5rem;" />
                    Sign In
                </button>

                <div class="auth-divider">
                    <span>or</span>
                </div>

                <div class="auth-footer">
                    <p class="auth-footer-text">
                        Don't have an account?
                        <a href="/Account/Register" class="auth-footer-link">Create a free account</a>
                    </p>
                </div>
            </form>

            <div class="auth-security-note">
                <RadzenIcon Icon="shield" Style="font-size: 1rem; margin-right: 0.5rem;" />
                <span>Protected by enterprise-grade AES-256 encryption</span>
            </div>
        </div>
    </div>
</div>

@code {
    private string? errorMessage;

    [SupplyParameterFromQuery]
    private string? ReturnUrl { get; set; }

    [SupplyParameterFromQuery(Name = "error")]
    private string? Error { get; set; }

    protected override void OnInitialized()
    {
        if (!string.IsNullOrEmpty(Error))
        {
            errorMessage = Error switch
            {
                "locked" => "Account locked out.",
                "invalid" => "Invalid email or password.",
                _ => "An error occurred during login."
            };
        }
    }
}
